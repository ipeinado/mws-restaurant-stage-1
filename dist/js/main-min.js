let restaurants,neighborhoods,cuisines;var map,markers=[];document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const s=document.createElement("option");s.innerHTML=e,s.value=e,t.append(s)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),s=e.selectedIndex,n=t.selectedIndex,r=e[s].value,a=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,a,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");if(e.forEach(e=>{t.append(createRestaurantHTML(e))}),"IntersectionObserver"in window){var s=[].slice.call(document.querySelectorAll(".lazy"));if("IntersectionObserver"in window){let e=new IntersectionObserver(function(t,s){t.forEach(function(t){if(t.isIntersecting){let s=t.target;s.src=s.dataset.src,s.srcset=s.dataset.srcset,s.classList.remove("lazy"),e.unobserve(s)}})});s.forEach(function(t){e.observe(t)})}}addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li");document.createElement("img").className="restaurant-img";const s=DBHelper.imageUrlForRestaurant(e),n=document.createElement("picture"),r="Image of "+e.name+" Restaurant",a=document.createElement("source"),o=s+"-small.webp 1x, "+s+"-medium.webp 2x";a.setAttribute("class","lazy"),a.setAttribute("type","image/webp"),a.setAttribute("data-srcset",o),a.setAttribute("alt",r),n.append(a);const l=document.createElement("source"),c=s+"-small.jpg 1x, "+s+"-medium.jpg 2x";l.setAttribute("class","lazy"),l.setAttribute("type","image/jpeg"),l.setAttribute("data-srcset",c),l.setAttribute("alt",r),n.append(l);const i=document.createElement("img");i.setAttribute("class","lazy"),i.setAttribute("data-src",s+"-small.jpg"),i.setAttribute("alt",r),n.append(i),t.append(n);const u=document.createElement("h3");u.innerHTML=e.name,t.append(u);const d=document.createElement("p");d.innerHTML=e.neighborhood,t.append(d);const m=document.createElement("p");m.innerHTML=e.address,t.append(m);const p=document.createElement("a");return p.innerHTML="View Details",p.setAttribute("aria-label","View Details about "+e.name),p.href=DBHelper.urlForRestaurant(e),t.append(p),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwiREJIZWxwZXIiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtIiwic2V0TWFwIiwidWwiLCJyZXN0YXVyYW50IiwiY3JlYXRlUmVzdGF1cmFudEhUTUwiLCJsYXp5SW1hZ2VzIiwic2xpY2UiLCJjYWxsIiwicXVlcnlTZWxlY3RvckFsbCIsImxhenlJbWFnZU9ic2VydmVyIiwiSW50ZXJzZWN0aW9uT2JzZXJ2ZXIiLCJlbnRyaWVzIiwib2JzZXJ2ZXIiLCJlbnRyeSIsImlzSW50ZXJzZWN0aW5nIiwibGF6eUltYWdlIiwidGFyZ2V0Iiwic3JjIiwiZGF0YXNldCIsInNyY3NldCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInVub2JzZXJ2ZSIsIm9ic2VydmUiLCJhZGRNYXJrZXJzVG9NYXAiLCJsaSIsImNsYXNzTmFtZSIsImltZ19uYW1lIiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50IiwicGljdHVyZSIsImFsdF90ZXh0IiwibmFtZSIsInNvdXJjZV93ZWJwIiwic3Jjc2V0X3dlYnAiLCJzZXRBdHRyaWJ1dGUiLCJzb3VyY2VfanBlZyIsInNyY3NldF9qcGVnIiwiaW1nIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsIm1hcmtlciIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsImxvY2F0aW9uIiwidXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsWUFDRkMsY0FDQUMsU0FDRixJQUFJQyxJQUNBQyxRQUFVLEdBS2RDLFNBQVNDLGlCQUFpQixtQkFBcUJDLElBQzdDQyxxQkFDQUMsa0JBTUZELG1CQUFxQixNQUNuQkUsU0FBU0YsbUJBQW1CLENBQUNHLEVBQU9WLEtBQzlCVSxFQUNGQyxRQUFRRCxNQUFNQSxJQUVkRSxLQUFLWixjQUFnQkEsRUFDckJhLDZCQVFOQSxzQkFBd0IsRUFBQ2IsRUFBZ0JZLEtBQUtaLGlCQUM1QyxNQUFNYyxFQUFTVixTQUFTVyxlQUFlLHdCQUN2Q2YsRUFBY2dCLFFBQVFDLElBQ3BCLE1BQU1DLEVBQVNkLFNBQVNlLGNBQWMsVUFDdENELEVBQU9FLFVBQVlILEVBQ25CQyxFQUFPRyxNQUFRSixFQUNmSCxFQUFPUSxPQUFPSixPQU9sQlYsY0FBZ0IsTUFDZEMsU0FBU0QsY0FBYyxDQUFDRSxFQUFPVCxLQUN6QlMsRUFDRkMsUUFBUUQsTUFBTUEsSUFFZEUsS0FBS1gsU0FBV0EsRUFDaEJzQix3QkFRTkEsaUJBQW1CLEVBQUN0QixFQUFXVyxLQUFLWCxZQUNsQyxNQUFNYSxFQUFTVixTQUFTVyxlQUFlLG1CQUV2Q2QsRUFBU2UsUUFBUVEsSUFDZixNQUFNTixFQUFTZCxTQUFTZSxjQUFjLFVBQ3RDRCxFQUFPRSxVQUFZSSxFQUNuQk4sRUFBT0csTUFBUUcsRUFDZlYsRUFBT1EsT0FBT0osT0FPbEJPLE9BQU9DLFFBQVUsTUFLZmQsS0FBS1YsSUFBTSxJQUFJeUIsT0FBT0MsS0FBS0MsSUFBSXpCLFNBQVNXLGVBQWUsT0FBUSxDQUM3RGUsS0FBTSxHQUNOQyxPQU5RLENBQ1JDLElBQUssVUFDTEMsS0FBTSxXQUtOQyxhQUFhLElBRWZDLHNCQU1GQSxrQkFBb0IsTUFDbEIsTUFBTUMsRUFBVWhDLFNBQVNXLGVBQWUsbUJBQ2xDc0IsRUFBVWpDLFNBQVNXLGVBQWUsd0JBRWxDdUIsRUFBU0YsRUFBUUcsY0FDakJDLEVBQVNILEVBQVFFLGNBRWpCZixFQUFVWSxFQUFRRSxHQUFRakIsTUFDMUJKLEVBQWVvQixFQUFRRyxHQUFRbkIsTUFFckNaLFNBQVNnQyx3Q0FBd0NqQixFQUFTUCxFQUFjLENBQUNQLEVBQU9YLEtBQzFFVyxFQUNGQyxRQUFRRCxNQUFNQSxJQUVkZ0MsaUJBQWlCM0MsR0FDakI0QywyQkFRTkQsaUJBQW1CLENBQUMzQyxJQUVsQmEsS0FBS2IsWUFBYyxHQUNSSyxTQUFTVyxlQUFlLG9CQUNoQ0ssVUFBWSxHQUdmUixLQUFLVCxRQUFRYSxRQUFRNEIsR0FBS0EsRUFBRUMsT0FBTyxPQUNuQ2pDLEtBQUtULFFBQVUsR0FDZlMsS0FBS2IsWUFBY0EsSUFNckI0QyxvQkFBc0IsRUFBQzVDLEVBQWNhLEtBQUtiLGVBQ3hDLE1BQU0rQyxFQUFLMUMsU0FBU1csZUFBZSxvQkFLbkMsR0FKQWhCLEVBQVlpQixRQUFRK0IsSUFDbEJELEVBQUd4QixPQUFPMEIscUJBQXFCRCxNQUc3Qix5QkFBMEJ0QixPQUFRLENBRXBDLElBQUl3QixFQUFhLEdBQUdDLE1BQU1DLEtBQUsvQyxTQUFTZ0QsaUJBQWlCLFVBRXpELEdBQUkseUJBQTBCM0IsT0FBUSxDQUNwQyxJQUFJNEIsRUFBb0IsSUFBSUMscUJBQXFCLFNBQVNDLEVBQVNDLEdBQ2pFRCxFQUFRdkMsUUFBUSxTQUFTeUMsR0FDdkIsR0FBSUEsRUFBTUMsZUFBZ0IsQ0FDeEIsSUFBSUMsRUFBWUYsRUFBTUcsT0FDdEJELEVBQVVFLElBQU1GLEVBQVVHLFFBQVFELElBQ2xDRixFQUFVSSxPQUFTSixFQUFVRyxRQUFRQyxPQUNyQ0osRUFBVUssVUFBVUMsT0FBTyxRQUMzQlosRUFBa0JhLFVBQVVQLFFBS2xDVixFQUFXakMsUUFBUSxTQUFTMkMsR0FDMUJOLEVBQWtCYyxRQUFRUixNQUtoQ1Msb0JBTUZwQixxQkFBdUIsQ0FBQ0QsSUFDdEIsTUFBTXNCLEVBQUtqRSxTQUFTZSxjQUFjLE1BRXBCZixTQUFTZSxjQUFjLE9BQy9CbUQsVUFBWSxpQkFDbEIsTUFBTUMsRUFBVzlELFNBQVMrRCxzQkFBc0J6QixHQUUxQzBCLEVBQVVyRSxTQUFTZSxjQUFjLFdBRWpDdUQsRUFBVyxZQUFjM0IsRUFBVzRCLEtBQU8sY0FFM0NDLEVBQWN4RSxTQUFTZSxjQUFjLFVBQ3JDMEQsRUFBY04sRUFBVyxtQkFBcUJBLEVBQVcsa0JBQy9ESyxFQUFZRSxhQUFhLFFBQVMsUUFDbENGLEVBQVlFLGFBQWEsT0FBUSxjQUNqQ0YsRUFBWUUsYUFBYSxjQUFlRCxHQUN4Q0QsRUFBWUUsYUFBYSxNQUFPSixHQUVoQ0QsRUFBUW5ELE9BQU9zRCxHQUVmLE1BQU1HLEVBQWMzRSxTQUFTZSxjQUFjLFVBQ3JDNkQsRUFBY1QsRUFBVyxrQkFBb0JBLEVBQVcsaUJBQzlEUSxFQUFZRCxhQUFhLFFBQVMsUUFDbENDLEVBQVlELGFBQWEsT0FBUSxjQUNqQ0MsRUFBWUQsYUFBYSxjQUFlRSxHQUN4Q0QsRUFBWUQsYUFBYSxNQUFPSixHQUVoQ0QsRUFBUW5ELE9BQU95RCxHQUVmLE1BQU1FLEVBQU03RSxTQUFTZSxjQUFjLE9BQ25DOEQsRUFBSUgsYUFBYSxRQUFTLFFBQzFCRyxFQUFJSCxhQUFhLFdBQVlQLEVBQVcsY0FDeENVLEVBQUlILGFBQWEsTUFBT0osR0FFeEJELEVBQVFuRCxPQUFPMkQsR0FFZlosRUFBRy9DLE9BQU9tRCxHQU9WLE1BQU1FLEVBQU92RSxTQUFTZSxjQUFjLE1BQ3BDd0QsRUFBS3ZELFVBQVkyQixFQUFXNEIsS0FDNUJOLEVBQUcvQyxPQUFPcUQsR0FFVixNQUFNMUQsRUFBZWIsU0FBU2UsY0FBYyxLQUM1Q0YsRUFBYUcsVUFBWTJCLEVBQVc5QixhQUNwQ29ELEVBQUcvQyxPQUFPTCxHQUVWLE1BQU1pRSxFQUFVOUUsU0FBU2UsY0FBYyxLQUN2QytELEVBQVE5RCxVQUFZMkIsRUFBV21DLFFBQy9CYixFQUFHL0MsT0FBTzRELEdBRVYsTUFBTUMsRUFBTy9FLFNBQVNlLGNBQWMsS0FNcEMsT0FMQWdFLEVBQUsvRCxVQUFZLGVBQ2pCK0QsRUFBS0wsYUFBYSxhQUFjLHNCQUF3Qi9CLEVBQVc0QixNQUNuRVEsRUFBS0MsS0FBTzNFLFNBQVM0RSxpQkFBaUJ0QyxHQUN0Q3NCLEVBQUcvQyxPQUFPNkQsR0FFSGQsSUFNVEQsZ0JBQWtCLEVBQUNyRSxFQUFjYSxLQUFLYixlQUNwQ0EsRUFBWWlCLFFBQVErQixJQUVsQixNQUFNdUMsRUFBUzdFLFNBQVM4RSx1QkFBdUJ4QyxFQUFZbkMsS0FBS1YsS0FDaEV5QixPQUFPQyxLQUFLdEIsTUFBTWtGLFlBQVlGLEVBQVEsUUFBUyxLQUM3QzdELE9BQU9nRSxTQUFTTCxLQUFPRSxFQUFPSSxNQUVoQzlFLEtBQUtULFFBQVF3RixLQUFLTCIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50cyxcclxuICBuZWlnaGJvcmhvb2RzLFxyXG4gIGN1aXNpbmVzXHJcbnZhciBtYXBcclxudmFyIG1hcmtlcnMgPSBbXVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxyXG4gKi9cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIG5laWdoYm9yaG9vZHMuZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfTtcclxuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICB6b29tOiAxMixcclxuICAgIGNlbnRlcjogbG9jLFxyXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgfSk7XHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxyXG4gKi9cclxucmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgc2VsZi5tYXJrZXJzLmZvckVhY2gobSA9PiBtLnNldE1hcChudWxsKSk7XHJcbiAgc2VsZi5tYXJrZXJzID0gW107XHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IHJlc3RhdXJhbnRzO1xyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIGFsbCByZXN0YXVyYW50cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmZpbGxSZXN0YXVyYW50c0hUTUwgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICB1bC5hcHBlbmQoY3JlYXRlUmVzdGF1cmFudEhUTUwocmVzdGF1cmFudCkpO1xyXG4gIH0pO1xyXG5cclxuICBpZiAoXCJJbnRlcnNlY3Rpb25PYnNlcnZlclwiIGluIHdpbmRvdykge1xyXG5cclxuICAgIHZhciBsYXp5SW1hZ2VzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxhenlcIikpO1xyXG5cclxuICAgIGlmIChcIkludGVyc2VjdGlvbk9ic2VydmVyXCIgaW4gd2luZG93KSB7XHJcbiAgICAgIGxldCBsYXp5SW1hZ2VPYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihmdW5jdGlvbihlbnRyaWVzLCBvYnNlcnZlcikge1xyXG4gICAgICAgIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbihlbnRyeSkge1xyXG4gICAgICAgICAgaWYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XHJcbiAgICAgICAgICAgIGxldCBsYXp5SW1hZ2UgPSBlbnRyeS50YXJnZXQ7XHJcbiAgICAgICAgICAgIGxhenlJbWFnZS5zcmMgPSBsYXp5SW1hZ2UuZGF0YXNldC5zcmM7XHJcbiAgICAgICAgICAgIGxhenlJbWFnZS5zcmNzZXQgPSBsYXp5SW1hZ2UuZGF0YXNldC5zcmNzZXQ7XHJcbiAgICAgICAgICAgIGxhenlJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKFwibGF6eVwiKTtcclxuICAgICAgICAgICAgbGF6eUltYWdlT2JzZXJ2ZXIudW5vYnNlcnZlKGxhenlJbWFnZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgbGF6eUltYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKGxhenlJbWFnZSkge1xyXG4gICAgICAgIGxhenlJbWFnZU9ic2VydmVyLm9ic2VydmUobGF6eUltYWdlKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhZGRNYXJrZXJzVG9NYXAoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgY29uc3QgaW1nX25hbWUgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgXHJcbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcclxuXHJcbiAgY29uc3QgYWx0X3RleHQgPSAnSW1hZ2Ugb2YgJyArIHJlc3RhdXJhbnQubmFtZSArICcgUmVzdGF1cmFudCc7XHJcblxyXG4gIGNvbnN0IHNvdXJjZV93ZWJwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgY29uc3Qgc3Jjc2V0X3dlYnAgPSBpbWdfbmFtZSArICctc21hbGwud2VicCAxeCwgJyArIGltZ19uYW1lICsgJy1tZWRpdW0ud2VicCAyeCc7XHJcbiAgc291cmNlX3dlYnAuc2V0QXR0cmlidXRlKCdjbGFzcycsICdsYXp5Jyk7XHJcbiAgc291cmNlX3dlYnAuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2ltYWdlL3dlYnAnKTtcclxuICBzb3VyY2Vfd2VicC5zZXRBdHRyaWJ1dGUoJ2RhdGEtc3Jjc2V0Jywgc3Jjc2V0X3dlYnApO1xyXG4gIHNvdXJjZV93ZWJwLnNldEF0dHJpYnV0ZSgnYWx0JywgYWx0X3RleHQpO1xyXG5cclxuICBwaWN0dXJlLmFwcGVuZChzb3VyY2Vfd2VicCk7XHJcblxyXG4gIGNvbnN0IHNvdXJjZV9qcGVnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgY29uc3Qgc3Jjc2V0X2pwZWcgPSBpbWdfbmFtZSArICctc21hbGwuanBnIDF4LCAnICsgaW1nX25hbWUgKyAnLW1lZGl1bS5qcGcgMngnO1xyXG4gIHNvdXJjZV9qcGVnLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnbGF6eScpO1xyXG4gIHNvdXJjZV9qcGVnLnNldEF0dHJpYnV0ZSgndHlwZScsICdpbWFnZS9qcGVnJyk7XHJcbiAgc291cmNlX2pwZWcuc2V0QXR0cmlidXRlKCdkYXRhLXNyY3NldCcsIHNyY3NldF9qcGVnKTtcclxuICBzb3VyY2VfanBlZy5zZXRBdHRyaWJ1dGUoJ2FsdCcsIGFsdF90ZXh0KTtcclxuXHJcbiAgcGljdHVyZS5hcHBlbmQoc291cmNlX2pwZWcpO1xyXG5cclxuICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuICBpbWcuc2V0QXR0cmlidXRlKCdjbGFzcycsICdsYXp5Jyk7XHJcbiAgaW1nLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmMnLCBpbWdfbmFtZSArICctc21hbGwuanBnJyk7XHJcbiAgaW1nLnNldEF0dHJpYnV0ZSgnYWx0JywgYWx0X3RleHQpO1xyXG5cclxuICBwaWN0dXJlLmFwcGVuZChpbWcpO1xyXG5cclxuICBsaS5hcHBlbmQocGljdHVyZSk7XHJcbiAgLy8gaW1hZ2Uuc3JjID0gaW1nX25hbWUuc3BsaXQoJy4nKVswXSArIFwiLXNtYWxsLlwiICsgJ2pwZyc7XHJcblxyXG4gIC8vIGltYWdlLnNldEF0dHJpYnV0ZSgnc3Jjc2V0JywgaW1nX25hbWUuc3BsaXQoJy4nKVswXSArIFwiLW1lZGl1bS5cIiArIGltZ19uYW1lLnNwbGl0KCcuJylbMV0gKyAnIDJ4Jyk7XHJcbiAgLy8gaW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCAnSW1hZ2Ugb2YgJyArIHJlc3RhdXJhbnQubmFtZSArIFwiIFJlc3RhdXJhbnRcIik7XHJcbiAgLy8gbGkuYXBwZW5kKGltYWdlKTtcclxuXHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgbGkuYXBwZW5kKG5hbWUpO1xyXG5cclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmVpZ2hib3Job29kLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmVpZ2hib3Job29kO1xyXG4gIGxpLmFwcGVuZChuZWlnaGJvcmhvb2QpO1xyXG5cclxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xyXG4gIGxpLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xyXG4gIG1vcmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ1ZpZXcgRGV0YWlscyBhYm91dCAnICsgcmVzdGF1cmFudC5uYW1lKTtcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGxpLmFwcGVuZChtb3JlKVxyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm1hcCk7XHJcbiAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsICgpID0+IHtcclxuICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICB9KTtcclxuICAgIHNlbGYubWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgfSk7XHJcbn1cclxuIl0sImZpbGUiOiJtYWluLW1pbi5qcyJ9
